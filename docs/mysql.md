### 1.mysql是否在扫描额外的记录

> 最简单的衡量查询开销的几个指标：
  * 响应时间 
   
     包括服务时间和排队时间
  * 扫描的行数 
  
     较短的行的访问速度更快  内存中的行比磁盘中的行的访问速度要快
  * 返回的行数
  * 扫描的行数和访问类型
   
    Using where 通过where条件
```
    1.在索引中使用where条件过滤不匹配记录，这是在存储引擎层完成的
    2.使用索引覆盖扫描（Extra列出现Using idnex） 直接从索引中过滤不需要的记录并返回命中结果 这是在mysql服务层完成的
    3.mysql先从数据表读出记录然后服务器层过滤 
```
 > 如果发现查询需要扫描大量的数据但是只返回少数的行，可以尝试通过以下技巧优化：
  * 使用索引覆盖扫描
  * 改变库表结构 例如使用单独的汇总表
  * 重写这个查询 尽量让mysql优化器能够以更优化的方式执行这个查询   
  
### 2.重构查询的方式
> 一个复杂查询还是多个简单查询

> 切分查询  

>分解关联查询
```
 1.让缓存的效率更高
 2.查询分解后 执行单个查询可以减少锁的竞争
 3.在应用层做关联，更容易对数据库进行拆分，更容易做到高性能和可扩展
 4.提升查询本身效率
 5.可以减少冗余记录的查询
 6.哈希关联 与 mysql的嵌套关联
```

### 3.查询执行的基础
> 查询执行过程
```aidl
   1. 客户端发送一条查询给服务器
   2. 服务器检查缓存，命中缓存则直接返回缓存中数据，否则进入下一阶段。
   3. 服务器端sql解析、预处理，再由优化器生成对应的执行计划
   4. mysql根据优化器生成的执行计划，调用存储引擎的API来执行查询
   5. 将结果返回给客户端
```